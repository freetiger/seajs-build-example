define("lvmama/eat",["jquery/jquery/1.10.1/jquery.js","gallery/underscore/1.6.0/underscore.js","gallery/backbone/1.1.2/backbone.js","gallery/underscore/1.6.0/underscore","jquery/jquery/1.10.1/jquery","gallery/mustache/0.8.1/mustache.js","./core","willkan/backbone-localStorage/1.1.6/backbone.localStorage.js","gallery/backbone/1.1.2/backbone"],function(a){var b=a("jquery/jquery/1.10.1/jquery.js"),c=(a("gallery/underscore/1.6.0/underscore.js"),a("gallery/backbone/1.1.2/backbone.js")),d=a("gallery/mustache/0.8.1/mustache.js"),e=a("./core");a("willkan/backbone-localStorage/1.1.6/backbone.localStorage.js");var f,g={},h={};h.resCollection=e.Collections.localStrorageCollection.extend({initialize:function(){this.fetch()}}),f=new h.resCollection,g.inputView=c.View.extend({el:b("#input-area"),collection:f,initialize:function(){this.input=this.$("#input-text"),this.verify()},events:{"keypress #input-text":"add_res","click #feel_lucky":"feel_lucky"},feel_lucky:function(a){var c,d,e=b(a.currentTarget),f=this;this.collection.length&&1!==this.collection.length&&(e.prop("disabled",!0),localStorage.generate_timestamp=Math.round(Date.now()/1e3),d=setInterval(function(){f.random_effect.call(f)},500),c=this.get_random_int(5e3,1e4),setTimeout(function(){clearInterval(d),f.collection.trigger("generated")},c))},random_effect:function(){var a=this.get_random_int(0,this.collection.length-1);this.collection.map(function(a){a.set("selected",!1)}),this.collection.at(a).set("selected",!0),this.collection.trigger("random")},get_random_int:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},generate_id:function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;5>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a},add_res:function(a){if(13==a.keyCode&&this.input.val()){var b={id:"res_"+this.generate_id(),restaurant:this.input.val()};this.input.val(""),this.collection.create(b)}},verify:function(){return localStorage.generate_timestamp?void(Math.round(Date.now()/1e3)-localStorage.generate_timestamp<3600&&this.$("#feel_lucky").prop("disabled",!0)):void(localStorage.generate_timestamp=0)}}),g.resList=c.View.extend({el:b("#restaurant"),template:b("#res-list-template").html(),collection:f,initialize:function(){this.res_list=this.$("#restaurant-list"),this.collection.on("add",this.add_res,this),this.collection.on("random",this.render,this),this.collection.on("generated",this.stop_random,this),this.render()},events:{"click button[action=delete]":"delete_res"},delete_res:function(a){var c=this,d=b(a.currentTarget),e=d.attr("res_id");this.collection.each(function(a){a.get("id")===e&&(a.destroy(),c.$("div[res_id="+e+"]").hide(500,function(){b(this).remove()}))})},add_res:function(){var a=b("#res-item-template").html(),c=d.to_html(a,this.collection.last().toJSON());this.$("#restaurant-list").append(c),this.$("#restaurant-list .col-lg-6:last").show(500)},stop_random:function(){this.$("#bingo").html("Bingo:")},render:function(){var a={res_list:this.collection.toJSON()};this.res_list.html(d.to_html(this.template,a))}}),new g.inputView,new g.resList}),define("lvmama/core",["gallery/backbone/1.1.2/backbone.js","gallery/underscore/1.6.0/underscore","jquery/jquery/1.10.1/jquery","willkan/backbone-localStorage/1.1.6/backbone.localStorage.js","gallery/backbone/1.1.2/backbone"],function(a){var b=a("gallery/backbone/1.1.2/backbone.js");a("willkan/backbone-localStorage/1.1.6/backbone.localStorage.js");var c={};return c.localStrorageCollection=b.Collection.extend({localStorage:new b.LocalStorage("restaurants")}),{Collections:c}});